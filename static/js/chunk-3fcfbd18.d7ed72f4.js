(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3fcfbd18"],{"009b":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:e.queryParams,size:"small",inline:!0,"label-width":"88px"}},[r("el-form-item",{attrs:{label:"单据类型",prop:"shippingType"}},[r("el-select",{attrs:{placeholder:"选择类型",clearable:""},model:{value:e.queryParams.shippingType,callback:function(t){e.$set(e.queryParams,"shippingType",t)},expression:"queryParams.shippingType"}},[r("el-option",{attrs:{value:1,label:"外购件物流"}}),r("el-option",{attrs:{value:3,label:"半成品物流"}}),r("el-option",{attrs:{value:2,label:"成品物流"}})],1)],1),1===e.queryParams.shippingType?r("el-form-item",{attrs:{label:"采购单号"}},[r("el-autocomplete",{attrs:{placeholder:"输入采购计划名称或采购单号","fetch-suggestions":e.fetchPOSuggestions,debounce:300,"trigger-on-focus":!0},on:{select:e.onPOQuerySelect},model:{value:e.poQuery,callback:function(t){e.poQuery=t},expression:"poQuery"}})],1):e._e(),2===e.queryParams.shippingType?r("el-form-item",{attrs:{label:"生产单号"}},[r("el-autocomplete",{attrs:{placeholder:"输入工单号或生产计划名称","fetch-suggestions":e.fetchMOSuggestions,debounce:300,"trigger-on-focus":!0},on:{select:e.onMOQuerySelect},model:{value:e.moQuery,callback:function(t){e.moQuery=t},expression:"moQuery"}})],1):e._e(),r("el-form-item",{attrs:{label:"状态",prop:"status"}},[r("el-select",{attrs:{placeholder:"选择状态",clearable:""},model:{value:e.queryParams.status,callback:function(t){e.$set(e.queryParams,"status",t)},expression:"queryParams.status"}},[r("el-option",{attrs:{value:0,label:"运输中"}}),r("el-option",{attrs:{value:1,label:"已完成"}})],1)],1),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")]),r("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1),r("el-row",{staticClass:"mb8",attrs:{gutter:10}},[r("el-col",{attrs:{span:2}},[r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["shipping:shipping:add"],expression:"['shipping:shipping:add']"}],attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"mini"},on:{click:e.handleAdd}},[e._v("新增")])],1),r("el-col",{attrs:{span:2}},[r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["shipping:shipping:edit"],expression:"['shipping:shipping:edit']"}],attrs:{type:"success",plain:"",icon:"el-icon-edit",size:"mini",disabled:e.single},on:{click:e.handleUpdate}},[e._v("修改")])],1),r("el-col",{attrs:{span:2}},[r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["shipping:shipping:export"],expression:"['shipping:shipping:export']"}],attrs:{type:"warning",plain:"",icon:"el-icon-download",size:"mini"},on:{click:e.handleExport}},[e._v("导出")])],1),r("right-toolbar",{attrs:{"show-search":e.showSearch},on:{"update:showSearch":function(t){e.showSearch=t},"update:show-search":function(t){e.showSearch=t},queryTable:e.getList}})],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.list},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),r("el-table-column",{attrs:{label:"编码",align:"center",prop:"shippingCode"}}),r("el-table-column",{attrs:{label:"单据类型",align:"center",prop:"shippingType"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{attrs:{type:1===t.row.shippingType?"info":2===t.row.shippingType?"primary":"success"}},[e._v(" "+e._s(1===t.row.shippingType?"外购件物流":2===t.row.shippingType?"成品物流":"半成品物流")+" ")])]}}])}),r("el-table-column",{attrs:{label:"运单号",align:"center",prop:"trackingNo"}}),r("el-table-column",{attrs:{label:"物流公司",align:"center",prop:"logisticsCompany"}}),r("el-table-column",{attrs:{label:"运输物料",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e.displayItemName(t.row)))])]}}])}),r("el-table-column",{attrs:{label:"运输数量",align:"center",prop:"shipQty"}}),r("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["已完成"===e.shippingStatus(t.row)?r("span",[r("el-tag",{attrs:{type:"success"}},[e._v("已完成")])],1):r("span",[r("el-tag",{attrs:{type:"warning"}},[e._v("运输中")])],1)]}}])}),r("el-table-column",{attrs:{label:"预计到货时间",align:"center",prop:"etaTime"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.parseTime(t.row.etaTime)))]}}])}),r("el-table-column",{attrs:{label:"备注",align:"center",prop:"remark"}}),r("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.canEdit(t.row)?r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["shipping:shipping:edit"],expression:"['shipping:shipping:edit']"}],attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(r){return e.handleUpdate(t.row)}}},[e._v("修改")]):e._e()]}}])})],1),r("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}),r("el-dialog",{attrs:{title:e.title,visible:e.open,width:"600px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"单据类型",prop:"shippingType"}},[r("el-radio-group",{model:{value:e.form.shippingType,callback:function(t){e.$set(e.form,"shippingType",t)},expression:"form.shippingType"}},[r("el-radio",{attrs:{label:1}},[e._v("外购件物流")]),r("el-radio",{attrs:{label:3}},[e._v("半成品物流")]),r("el-radio",{attrs:{label:2}},[e._v("成品物流")])],1)],1),1===e.form.shippingType?r("el-form-item",{attrs:{label:"采购单号",prop:"purchaseOrderNo"}},[r("el-autocomplete",{staticStyle:{width:"100%"},attrs:{placeholder:"输入采购计划名称或采购单号","fetch-suggestions":e.fetchPOSuggestions,debounce:300,"trigger-on-focus":!0},on:{select:e.onPODialogSelect},model:{value:e.poDialogQuery,callback:function(t){e.poDialogQuery=t},expression:"poDialogQuery"}})],1):e._e(),1===e.form.shippingType?r("el-form-item",{attrs:{label:"物料名称"}},[r("el-input",{attrs:{placeholder:"自动带入",disabled:""},model:{value:e.form.accessoryName,callback:function(t){e.$set(e.form,"accessoryName",t)},expression:"form.accessoryName"}})],1):e._e(),1===e.form.shippingType?r("el-form-item",{attrs:{label:"运输数量",prop:"shipQty"}},[r("el-input-number",{attrs:{min:1,max:e.poSelectedQty||void 0,step:1,"controls-position":"right",placeholder:"请输入运输数量"},model:{value:e.form.shipQty,callback:function(t){e.$set(e.form,"shipQty",t)},expression:"form.shipQty"}})],1):e._e(),1!==e.form.shippingType?r("el-form-item",{attrs:{label:"关联出库单",prop:"relatedDeliveryId"}},[r("el-autocomplete",{attrs:{placeholder:"输入出库名称搜索","fetch-suggestions":e.fetchDeliverySuggestions,debounce:300,"trigger-on-focus":!0},on:{select:e.onDeliveryDialogSelect},model:{value:e.deliveryDialogQuery,callback:function(t){e.deliveryDialogQuery=t},expression:"deliveryDialogQuery"}})],1):e._e(),1!==e.form.shippingType?r("el-form-item",{attrs:{label:"运输数量",prop:"shipQty"}},[r("el-input-number",{attrs:{min:1,step:1,"controls-position":"right",placeholder:"请输入运输数量"},model:{value:e.form.shipQty,callback:function(t){e.$set(e.form,"shipQty",t)},expression:"form.shipQty"}})],1):e._e(),r("el-form-item",{attrs:{label:"物流公司",prop:"logisticsCompany"}},[r("el-input",{attrs:{placeholder:"请输入物流公司"},model:{value:e.form.logisticsCompany,callback:function(t){e.$set(e.form,"logisticsCompany",t)},expression:"form.logisticsCompany"}})],1),r("el-form-item",{attrs:{label:"运单号",prop:"trackingNo"}},[r("el-input",{attrs:{placeholder:"请输入运单号"},model:{value:e.form.trackingNo,callback:function(t){e.$set(e.form,"trackingNo",t)},expression:"form.trackingNo"}})],1),1===e.form.shippingType?r("el-form-item",{attrs:{label:"预计到货时间",prop:"etaTime"}},[r("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择时间","value-format":"timestamp"},model:{value:e.form.etaTime,callback:function(t){e.$set(e.form,"etaTime",t)},expression:"form.etaTime"}})],1):e._e(),r("el-form-item",{attrs:{label:"备注",prop:"remark"}},[r("el-input",{attrs:{placeholder:"请输入备注"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),r("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)},a=[],i=r("2909"),o=r("5530"),s=(r("99af"),r("4de4"),r("7db0"),r("a630"),r("d81d"),r("14d9"),r("a9e3"),r("f00c"),r("d3b7"),r("6062"),r("3ca3"),r("498a"),r("0643"),r("2382"),r("fffc"),r("a573"),r("ddb0"),r("b3a9")),u=r("8d7a"),c=r("e988"),l=r("2d7b"),p=r("fba1"),m={name:"Shipping",data:function(){return{loading:!0,ids:[],single:!0,showSearch:!0,total:0,list:[],title:"",open:!1,queryParams:{pageNum:1,pageSize:10,shippingType:null,purchaseOrderNo:null,workOrderNo:null,status:null},poOptions:[],moOptions:[],poLoading:!1,moLoading:!1,poQuery:"",moQuery:"",poDialogQuery:"",moDialogQuery:"",poNameDict:{},planStatusDict:{},itemNameDict:{},poSelectedQty:null,deliveryDialogQuery:"",form:{},rules:{shippingType:[{required:!0,message:"单据类型不能为空",trigger:"change"}],purchaseOrderNo:[{required:!0,message:"采购单号不能为空",trigger:"change"}],relatedDeliveryId:[{required:!0,message:"请选择关联出库单",trigger:"change"}],shipQty:[{required:!0,message:"运输数量不能为空",trigger:"change"}],logisticsCompany:[{required:!0,message:"物流公司不能为空",trigger:"blur"}],trackingNo:[{required:!0,message:"运单号不能为空",trigger:"blur"}]}}},watch:{"queryParams.shippingType":function(e){1===e?this.queryParams.workOrderNo=null:2===e?this.queryParams.purchaseOrderNo=null:3===e&&(this.queryParams.purchaseOrderNo=null,this.queryParams.workOrderNo=null)},"form.shippingType":function(e){1===e?this.form.workOrderNo=null:2===e?this.form.purchaseOrderNo=null:3===e&&(this.form.purchaseOrderNo=null,this.form.workOrderNo=null)}},created:function(){this.getList()},methods:{fetchPOSuggestions:function(e,t){var r=this,n=(e||"").trim();this.poLoading=!0;var a=n?{auditStatus:2,procurementPlanName:n,purchaseOrderNo:n,pageNum:1,pageSize:20}:{auditStatus:2,pageNum:1,pageSize:20};Object(u["g"])(a).then((function(e){var r=(e.rows||[]).map((function(e){return{value:"".concat(e.procurementPlanName||"采购计划").concat(e.purchaseOrderNo?" - "+e.purchaseOrderNo:""),purchaseOrderNo:e.purchaseOrderNo,id:e.procurementPlanId,qty:e.procurementPlanNum,materialId:e.lpMaterialId}}));t(r)})).finally((function(){r.poLoading=!1}))},onPOQuerySelect:function(e){this.queryParams.purchaseOrderNo=e&&e.purchaseOrderNo?e.purchaseOrderNo:null,this.poQuery=e&&e.value?e.value:""},onPODialogSelect:function(e){var t=this;e&&(this.form.purchaseOrderNo=e.purchaseOrderNo||null,this.form.procurementPlanId=e.id||null,this.poSelectedQty=e.qty||null,this.form.shipQty=e.qty||null,e.materialId?Object(l["a"])(e.materialId).then((function(e){var r=e&&e.data;t.$set(t.form,"accessoryName",r?r.accessoryName:"")})).catch((function(){t.$set(t.form,"accessoryName","")})):this.$set(this.form,"accessoryName",""))},fetchMOSuggestions:function(e,t){var r=this,n=(e||"").trim();this.moLoading=!0;var a=n?{workOrderNo:n,planName:n,pageNum:1,pageSize:20}:{pageNum:1,pageSize:20};Object(c["d"])(a).then((function(e){var r=(e.rows||[]).map((function(e){return{value:"".concat(e.workOrderNo||"").concat(e.planName?" - "+e.planName:""),workOrderNo:e.workOrderNo,id:e.planId}}));t(r)})).finally((function(){r.moLoading=!1}))},onMOQuerySelect:function(e){this.queryParams.workOrderNo=e&&e.workOrderNo?e.workOrderNo:null,this.moQuery=e&&e.value?e.value:""},onMODialogSelect:function(e){},fetchDeliverySuggestions:function(e,t){var r=(e||"").trim();Object(p["d"])({warehouseDeliveryName:r,pageNum:1,pageSize:20}).then((function(e){var r=(e.rows||[]).map((function(e){return{value:e.warehouseDeliveryName,warehouseDeliveryId:e.warehouseDeliveryId,warehouseDeliveryNum:e.warehouseDeliveryNum,unit:e.unit}}));t(r)})).catch((function(){return t([])}))},onDeliveryDialogSelect:function(e){e&&(this.form.relatedDeliveryId=e.warehouseDeliveryId||null,this.deliveryDialogQuery=e.value||"",this.form.accessoryName=e.value||this.form.accessoryName,this.form.shipQty||(this.form.shipQty=e.warehouseDeliveryNum||this.form.shipQty),!this.form.unit&&e.unit&&this.$set(this.form,"unit",e.unit))},remoteSearchPO:function(e){var t=this,r=(e||"").trim();this.poLoading=!0;var n=r?{auditStatus:2,procurementPlanName:r,purchaseOrderNo:r,pageNum:1,pageSize:9999}:{auditStatus:2,pageNum:1,pageSize:9999};Object(u["g"])(n).then((function(e){t.poOptions=(e.rows||[]).map((function(e){return{value:e.purchaseOrderNo,label:"".concat(e.procurementPlanName||"采购计划").concat(e.purchaseOrderNo?" - "+e.purchaseOrderNo:""),id:e.procurementPlanId,qty:e.procurementPlanNum,materialId:e.lpMaterialId}})),t.poLoading=!1})).catch((function(){t.poLoading=!1}))},onPOVisibleChange:function(e){e&&this.remoteSearchPO("")},remoteSearchMO:function(e){var t=this;e?(this.moLoading=!0,Object(c["d"])({workOrderNo:e,pageNum:1,pageSize:10}).then((function(e){t.moOptions=(e.rows||[]).map((function(e){return{value:e.workOrderNo,label:"".concat(e.workOrderNo).concat(e.planName?" - "+e.planName:""),id:e.planId,finishedProductId:e.finishedProductId}})),t.moLoading=!1})).catch((function(){t.moLoading=!1}))):this.moOptions=[]},getList:function(){var e=this;this.loading=!0,Object(s["c"])(this.queryParams).then((function(t){e.list=t.rows,e.total=t.total,e.loading=!1,e.resolvePONameMap(t.rows||[]),e.resolveItemNames(t.rows||[])}))},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.queryParams.purchaseOrderNo=null,this.queryParams.workOrderNo=null,this.queryParams.status=null,this.poQuery="",this.moQuery="",this.handleQuery()},handleSelectionChange:function(e){this.ids=e.map((function(e){return e.shippingId})),this.single=1!==e.length},handleAdd:function(){this.reset(),this.open=!0,this.title="新增发运"},handleUpdate:function(e){var t=this,r=e||(Array.isArray(this.list)?this.list.find((function(e){return e&&e.shippingId===(Array.isArray(t.ids)&&t.ids.length?t.ids[0]:null)})):null);if(!r||this.canEdit(r)){this.reset();var n=e&&e.shippingId?e.shippingId:Array.isArray(this.ids)&&this.ids.length?this.ids[0]:null;n?Object(s["b"])(n).then((function(e){if(t.form=e.data,t.form&&1===t.form.shippingType?t.poDialogQuery=t.form.purchaseOrderNo||"":t.form&&2===t.form.shippingType&&(t.moDialogQuery=t.form.workOrderNo||""),t.form&&t.form.etaTime)try{var r="number"===typeof t.form.etaTime?t.form.etaTime:new Date(t.form.etaTime).getTime();Number.isFinite(r)&&(t.form.etaTime=r)}catch(n){}t.open=!0,t.title="修改发运"})):this.$modal.msgWarning("请选择一条记录")}else this.$modal.msgWarning("已完成不可修改")},handleExport:function(){this.download("shipping/shipping/export",Object(o["a"])({},this.queryParams),"shipping_".concat((new Date).getTime(),".xlsx"))},cancel:function(){this.open=!1,this.reset()},reset:function(){this.form={shippingId:null,shippingType:1,purchaseOrderNo:null,workOrderNo:null,relatedDeliveryId:null,procurementPlanId:null,productionPlanId:null,accessoryName:null,shipQty:null,logisticsCompany:null,trackingNo:null,etaTime:null,remark:null},this.poDialogQuery="",this.moDialogQuery="",this.deliveryDialogQuery="",this.poSelectedQty=null,this.resetForm("form")},onPOChange:function(e){var t=this,r=this.poOptions.find((function(t){return t.value===e}));r&&(this.form.shipQty=r.qty||0,this.form.procurementPlanId=r.id,this.poSelectedQty=r.qty||null,r.materialId?Object(l["a"])(r.materialId).then((function(e){var r=e&&e.data;t.$set(t.form,"accessoryName",r?r.accessoryName:"")})).catch((function(){t.$set(t.form,"accessoryName","")})):this.$set(this.form,"accessoryName",""))},onPlanChange:function(e){var t=this,r=this.poOptions.find((function(t){return t.id===e}));r&&(this.form.purchaseOrderNo=r.value||null,this.form.shipQty=r.qty||0,this.poSelectedQty=r.qty||null,r.materialId?Object(l["a"])(r.materialId).then((function(e){var r=e&&e.data;t.$set(t.form,"accessoryName",r?r.accessoryName:"")})).catch((function(){t.$set(t.form,"accessoryName","")})):this.$set(this.form,"accessoryName",""))},goToPurchaseByNo:function(e){var t=this,r=e&&e.purchaseOrderNo;r&&Object(u["g"])({purchaseOrderNo:r,pageNum:1,pageSize:1}).then((function(e){var r=(e.rows||[])[0];r&&r.procurementPlanId&&t.$router.push("/procurementPlan-data/procurementPlan/".concat(r.procurementPlanId))}))},goToProductionByNo:function(e){var t=this,r=e&&e.workOrderNo;r&&Object(c["d"])({workOrderNo:r,pageNum:1,pageSize:1}).then((function(e){var r=(e.rows||[])[0];r&&r.planId&&t.$router.push("/productionPlan-data/productionPlan/".concat(r.planId))}))},submitForm:function(){var e=this,t=function(){var t=e.form.shippingId?s["d"]:s["a"];return t(e.form).then((function(){return 1===e.form.shippingType&&e.form.procurementPlanId?Object(u["h"])({procurementPlanId:e.form.procurementPlanId}).catch((function(){return e.$modal.msgWarning("发运保存成功，但采购计划状态未更新，请检查审批状态"),Promise.resolve()})):Promise.resolve()}))};this.$refs["form"].validate((function(r){if(r)if(1===e.form.shippingType){if(!e.form.purchaseOrderNo)return void e.$modal.msgError("请选择采购单号");var n=Number(e.form.shipQty||0);if(!Number.isFinite(n)||n<=0)return void e.$modal.msgError("请输入有效运输数量");if(null!=e.poSelectedQty&&n>Number(e.poSelectedQty))return void e.$modal.msgError("运输数量不可超过采购计划数量");if(!e.form.procurementPlanId)return void Object(u["g"])({purchaseOrderNo:e.form.purchaseOrderNo,auditStatus:2,pageNum:1,pageSize:1}).then((function(r){var n=(r.rows||[])[0];n&&n.procurementPlanId?(e.form.procurementPlanId=n.procurementPlanId,t().then((function(){e.$modal.msgSuccess("保存成功"),e.open=!1,e.getList()})).catch((function(t){e.$modal.msgError(t&&t.msg||t&&t.message||"保存失败")}))):e.$modal.msgError("未找到已审批的采购单")})).catch((function(){e.$modal.msgError("查询采购单失败")}));t().then((function(){e.$modal.msgSuccess("保存成功"),e.open=!1,e.getList()})).catch((function(t){e.$modal.msgError(t&&t.msg||t&&t.message||"保存失败")}))}else{if(1!==e.form.shippingType){var a=Number(e.form.shipQty||0);if(!e.form.relatedDeliveryId)return void e.$modal.msgError("请选择关联出库单");if(!Number.isFinite(a)||a<=0)return void e.$modal.msgError("请输入有效运输数量")}t().then((function(){e.$modal.msgSuccess("保存成功"),e.open=!1,e.getList()})).catch((function(t){e.$modal.msgError(t&&t.msg||t&&t.message||"保存失败")}))}}))},onMOChange:function(e){var t=this.moOptions.find((function(t){return t.value===e}));t&&(this.form.productionPlanId=t.id)},displayItemName:function(e){return e?1===e.shippingType?e.accessoryName||this.itemNameDict["po:"+(e.procurementPlanId||e.purchaseOrderNo)]||"-":2===e.shippingType?this.itemNameDict["mo:"+(e.productionPlanId||e.workOrderNo)]||"-":"半成品":"-"},shippingStatus:function(e){if(!e)return"运输中";if(1===e.shippingType){var t=null!=this.planStatusDict[e.purchaseOrderNo]?this.planStatusDict[e.purchaseOrderNo]:this.planStatusDict[e.procurementPlanId];return 4===t?"已完成":"运输中"}return"运输中"},resolveItemNames:function(e){var t=this,r=Array.from(new Set((e||[]).filter((function(e){return 1===e.shippingType&&!e.accessoryName&&(e.procurementPlanId||e.purchaseOrderNo)})).map((function(e){return e.procurementPlanId||e.purchaseOrderNo})))),n=Array.from(new Set((e||[]).filter((function(e){return 2===e.shippingType&&(e.productionPlanId||e.workOrderNo)})).map((function(e){return e.productionPlanId||e.workOrderNo})))),a=r.map((function(e){if(t.itemNameDict["po:"+e])return Promise.resolve();var r="number"===typeof e,n=r?Object(u["f"])(e):Object(u["g"])({purchaseOrderNo:e,pageNum:1,pageSize:1});return n.then((function(n){var a=r?n&&n.data:(n.rows||[])[0],i=a&&a.lpMaterialId,o=a&&a.purchaseOrderNo,s=a&&a.procurementPlanId;if(o&&t.$set(t.planStatusDict,o,a.auditStatus),null!=s&&t.$set(t.planStatusDict,s,a.auditStatus),i)return Object(l["a"])(i).then((function(r){var n=r&&r.data&&r.data.accessoryName||"-";t.$set(t.itemNameDict,"po:"+e,n)}));t.$set(t.itemNameDict,"po:"+e,"-")})).catch((function(){t.$set(t.itemNameDict,"po:"+e,"-")}))})),o=n.map((function(e){if(t.itemNameDict["mo:"+e])return Promise.resolve();var r="number"===typeof e,n=r?Object(c["c"])(e):Object(c["d"])({workOrderNo:e,pageNum:1,pageSize:1});return n.then((function(n){var a=r?n&&n.data:(n.rows||[])[0],i=a&&a.planName||"-";t.$set(t.itemNameDict,"mo:"+e,i)})).catch((function(){t.$set(t.itemNameDict,"mo:"+e,"-")}))}));Promise.all([].concat(Object(i["a"])(a),Object(i["a"])(o))).catch((function(){}))},resolvePONameMap:function(e){var t=this,r=Array.from(new Set((e||[]).filter((function(e){return 1===e.shippingType&&e.purchaseOrderNo})).map((function(e){return e.purchaseOrderNo}))));if(r.length){var n=r.map((function(e){return Object(u["g"])({purchaseOrderNo:e,pageNum:1,pageSize:1}).then((function(r){var n=(r.rows||[])[0];n&&n.purchaseOrderNo?(t.$set(t.poNameDict,n.purchaseOrderNo,n.procurementPlanName||"采购计划"),t.$set(t.planStatusDict,n.purchaseOrderNo,n.auditStatus)):t.$set(t.poNameDict,e,"-")})).catch((function(){t.$set(t.poNameDict,e,"-")}))}));Promise.all(n).catch((function(){}))}},canEdit:function(e){return"已完成"!==this.shippingStatus(e)}}},d=m,f=r("2877"),h=Object(f["a"])(d,n,a,!1,null,null,null);t["default"]=h.exports},"1c59":function(e,t,r){"use strict";var n=r("6d61"),a=r("6566");n("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),a)},"2d7b":function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return o}));var n=r("5530"),a=(r("d9e2"),r("d81d"),r("d3b7"),r("0643"),r("a573"),r("b775"));function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={pageNum:e.pageNum,pageSize:e.pageSize,itemName:e.accessoryName||e.itemName,unit:e.unit,categoryId:e.accessoryClassifyId||e.categoryId,status:e.status};return Object(a["a"])({url:"/materials/item/list",method:"get",params:t}).then((function(e){var t=e&&e.rows?e.rows:[],r=t.map((function(e){return{itemId:e.itemId,accessoryName:e.itemName,accessoryNum:e.itemNum,accessoryPrice:e.price,unit:e.unit,accessoryClassifyId:e.categoryId,supplierId:e.supplierId,status:e.status,remark:e.remark,createBy:e.createBy,createTime:e.createTime,updateBy:e.updateBy,updateTime:e.updateTime}}));return Object(n["a"])(Object(n["a"])({},e),{},{rows:r})}))}function o(e){var t=e;return Object(a["a"])({url:"/materials/item/"+t,method:"get"}).then((function(e){var t=e&&e.data?e.data:{},r={itemId:t.itemId,accessoryName:t.itemName,accessoryNum:t.itemNum,accessoryPrice:t.price,unit:t.unit,accessoryClassifyId:t.categoryId,supplierId:t.supplierId,status:t.status,remark:t.remark,createBy:t.createBy,createTime:t.createTime,updateBy:t.updateBy,updateTime:t.updateTime};return Object(n["a"])(Object(n["a"])({},e),{},{data:r})}))}},"4fad":function(e,t,r){var n=r("d039"),a=r("861d"),i=r("c6b6"),o=r("d86b"),s=Object.isExtensible,u=n((function(){s(1)}));e.exports=u||o?function(e){return!!a(e)&&((!o||"ArrayBuffer"!=i(e))&&(!s||s(e)))}:s},6062:function(e,t,r){r("1c59")},6566:function(e,t,r){"use strict";var n=r("9bf2").f,a=r("7c73"),i=r("6964"),o=r("0366"),s=r("19aa"),u=r("7234"),c=r("2266"),l=r("c6d2"),p=r("4754"),m=r("2626"),d=r("83ab"),f=r("f183").fastKey,h=r("69f3"),g=h.set,y=h.getterFor;e.exports={getConstructor:function(e,t,r,l){var p=e((function(e,n){s(e,m),g(e,{type:t,index:a(null),first:void 0,last:void 0,size:0}),d||(e.size=0),u(n)||c(n,e[l],{that:e,AS_ENTRIES:r})})),m=p.prototype,h=y(t),v=function(e,t,r){var n,a,i=h(e),o=b(e,t);return o?o.value=r:(i.last=o={index:a=f(t,!0),key:t,value:r,previous:n=i.last,next:void 0,removed:!1},i.first||(i.first=o),n&&(n.next=o),d?i.size++:e.size++,"F"!==a&&(i.index[a]=o)),e},b=function(e,t){var r,n=h(e),a=f(t);if("F"!==a)return n.index[a];for(r=n.first;r;r=r.next)if(r.key==t)return r};return i(m,{clear:function(){var e=this,t=h(e),r=t.index,n=t.first;while(n)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete r[n.index],n=n.next;t.first=t.last=void 0,d?t.size=0:e.size=0},delete:function(e){var t=this,r=h(t),n=b(t,e);if(n){var a=n.next,i=n.previous;delete r.index[n.index],n.removed=!0,i&&(i.next=a),a&&(a.previous=i),r.first==n&&(r.first=a),r.last==n&&(r.last=i),d?r.size--:t.size--}return!!n},forEach:function(e){var t,r=h(this),n=o(e,arguments.length>1?arguments[1]:void 0);while(t=t?t.next:r.first){n(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!b(this,e)}}),i(m,r?{get:function(e){var t=b(this,e);return t&&t.value},set:function(e,t){return v(this,0===e?0:e,t)}}:{add:function(e){return v(this,e=0===e?0:e,e)}}),d&&n(m,"size",{get:function(){return h(this).size}}),p},setStrong:function(e,t,r){var n=t+" Iterator",a=y(t),i=y(n);l(e,t,(function(e,t){g(this,{type:n,target:e,state:a(e),kind:t,last:void 0})}),(function(){var e=i(this),t=e.kind,r=e.last;while(r&&r.removed)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?p("keys"==t?r.key:"values"==t?r.value:[r.key,r.value],!1):(e.target=void 0,p(void 0,!0))}),r?"entries":"values",!r,!0),m(t)}}},"6d61":function(e,t,r){"use strict";var n=r("23e7"),a=r("da84"),i=r("e330"),o=r("94ca"),s=r("cb2d"),u=r("f183"),c=r("2266"),l=r("19aa"),p=r("1626"),m=r("7234"),d=r("861d"),f=r("d039"),h=r("1c7e"),g=r("d44e"),y=r("7156");e.exports=function(e,t,r){var v=-1!==e.indexOf("Map"),b=-1!==e.indexOf("Weak"),N=v?"set":"add",O=a[e],w=O&&O.prototype,P=O,S={},k=function(e){var t=i(w[e]);s(w,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(b&&!d(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return b&&!d(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(b&&!d(e))&&t(this,0===e?0:e)}:function(e,r){return t(this,0===e?0:e,r),this})},I=o(e,!p(O)||!(b||w.forEach&&!f((function(){(new O).entries().next()}))));if(I)P=r.getConstructor(t,e,v,N),u.enable();else if(o(e,!0)){var D=new P,x=D[N](b?{}:-0,1)!=D,T=f((function(){D.has(1)})),Q=h((function(e){new O(e)})),j=!b&&f((function(){var e=new O,t=5;while(t--)e[N](t,t);return!e.has(-0)}));Q||(P=t((function(e,t){l(e,w);var r=y(new O,e,P);return m(t)||c(t,r[N],{that:r,AS_ENTRIES:v}),r})),P.prototype=w,w.constructor=P),(T||j)&&(k("delete"),k("has"),v&&k("get")),(j||x)&&k(N),b&&w.clear&&delete w.clear}return S[e]=P,n({global:!0,constructor:!0,forced:P!=O},S),g(P,e),b||r.setStrong(P,e,v),P}},"8d7a":function(e,t,r){"use strict";r.d(t,"g",(function(){return a})),r.d(t,"f",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"d",(function(){return u})),r.d(t,"h",(function(){return c})),r.d(t,"c",(function(){return l})),r.d(t,"i",(function(){return p})),r.d(t,"e",(function(){return m}));var n=r("b775");function a(e){return Object(n["a"])({url:"/procurementPlan/procurementPlan/list",method:"get",params:e})}function i(e){return Object(n["a"])({url:"/procurementPlan/procurementPlan/"+e,method:"get"})}function o(e){return Object(n["a"])({url:"/procurementPlan/procurementPlan",method:"post",data:e})}function s(e){return Object(n["a"])({url:"/procurementPlan/procurementPlan/approver",method:"put",data:e})}function u(e){return Object(n["a"])({url:"/procurementPlan/procurementPlan/audit",method:"put",data:e})}function c(e){return Object(n["a"])({url:"/procurementPlan/procurementPlan/ship",method:"put",data:e})}function l(e){return Object(n["a"])({url:"/procurementPlan/procurementPlan/arrive",method:"put",data:e})}function p(e){return Object(n["a"])({url:"/procurementPlan/procurementPlan",method:"put",data:e})}function m(e){return Object(n["a"])({url:"/procurementPlan/procurementPlan/"+e,method:"delete"})}},b3a9:function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"d",(function(){return s}));var n=r("b775");function a(e){return Object(n["a"])({url:"/shipping/shipping/list",method:"get",params:e})}function i(e){return Object(n["a"])({url:"/shipping/shipping/".concat(e),method:"get"})}function o(e){return Object(n["a"])({url:"/shipping/shipping",method:"post",data:e})}function s(e){return Object(n["a"])({url:"/shipping/shipping",method:"put",data:e})}},bb2f:function(e,t,r){var n=r("d039");e.exports=!n((function(){return Object.isExtensible(Object.preventExtensions({}))}))},d86b:function(e,t,r){var n=r("d039");e.exports=n((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))},e285:function(e,t,r){var n=r("da84"),a=n.isFinite;e.exports=Number.isFinite||function(e){return"number"==typeof e&&a(e)}},e988:function(e,t,r){"use strict";r.d(t,"d",(function(){return a})),r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"f",(function(){return s})),r.d(t,"b",(function(){return u})),r.d(t,"e",(function(){return c}));var n=r("b775");function a(e){return Object(n["a"])({url:"/production/plan/list",method:"get",params:e})}function i(e){return Object(n["a"])({url:"/production/plan/"+e,method:"get"})}function o(e){return Object(n["a"])({url:"/production/plan",method:"post",data:e})}function s(e){return Object(n["a"])({url:"/production/plan",method:"put",data:e})}function u(e){return Object(n["a"])({url:"/production/plan/"+e,method:"delete"})}function c(e){return Object(n["a"])({url:"/production/plan/"+e+"/next",method:"post"})}},f00c:function(e,t,r){var n=r("23e7"),a=r("e285");n({target:"Number",stat:!0},{isFinite:a})},f183:function(e,t,r){var n=r("23e7"),a=r("e330"),i=r("d012"),o=r("861d"),s=r("1a2d"),u=r("9bf2").f,c=r("241c"),l=r("057f"),p=r("4fad"),m=r("90e3"),d=r("bb2f"),f=!1,h=m("meta"),g=0,y=function(e){u(e,h,{value:{objectID:"O"+g++,weakData:{}}})},v=function(e,t){if(!o(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!s(e,h)){if(!p(e))return"F";if(!t)return"E";y(e)}return e[h].objectID},b=function(e,t){if(!s(e,h)){if(!p(e))return!0;if(!t)return!1;y(e)}return e[h].weakData},N=function(e){return d&&f&&p(e)&&!s(e,h)&&y(e),e},O=function(){w.enable=function(){},f=!0;var e=c.f,t=a([].splice),r={};r[h]=1,e(r).length&&(c.f=function(r){for(var n=e(r),a=0,i=n.length;a<i;a++)if(n[a]===h){t(n,a,1);break}return n},n({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:l.f}))},w=e.exports={enable:O,fastKey:v,getWeakData:b,onFreeze:N};i[h]=!0},fba1:function(e,t,r){"use strict";r.d(t,"d",(function(){return a})),r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"e",(function(){return s})),r.d(t,"b",(function(){return u}));var n=r("b775");function a(e){return Object(n["a"])({url:"/warehouseDelivery/warehouseDelivery/list",method:"get",params:e})}function i(e){return Object(n["a"])({url:"/warehouseDelivery/warehouseDelivery/"+e,method:"get"})}function o(e){return Object(n["a"])({url:"/warehouseDelivery/warehouseDelivery",method:"post",data:e})}function s(e){return Object(n["a"])({url:"/warehouseDelivery/warehouseDelivery",method:"put",data:e})}function u(e){return Object(n["a"])({url:"/warehouseDelivery/warehouseDelivery/"+e,method:"delete"})}}}]);